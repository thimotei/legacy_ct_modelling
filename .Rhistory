lmean = EpiNow2::incubation_periods[, mean],
lsd = EpiNow2::incubation_periods[, sd])
}
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
stan_data_delta
dt.ct.delta$infection_id
dt.ct.omicron$infection_id
stan_data_fun <- function(input_data) {
list(N = input_data[, .N],
P = input_data[, uniqueN(id)],
id = input_data[, id],
day_rel = input_data[, day_rel],
ct_value = ifelse(is.na(input_data$ct_value), -99, input_data$ct_scaled),
pcr_res = input_data[, as.numeric(result)],
symp_rel = input_data[, unique(symp_rel), by = id][, V1],
t_e = 0,
c_0 = (45 - mn)/(mx - mn),
c_lod = (45 - mn)/(mx - mn),
lmean = EpiNow2::incubation_periods[, mean],
lsd = EpiNow2::incubation_periods[, sd])
}
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
dt.ct.delta
dt.ct <- fread("ct_dynamics/data/ct_values_updated.csv") %>%
setnames(., c("Study number", "sample date", "barcode",
"Ct", "swab type", "sample order", "Day post swab 1",
"VOC", "Symptom onset", "Days post symptom onset"),
c("id", "date", "barcode", "ct_value", "swab_type", "sample_id",
"days_since_first_swab", "voc", "symptom_onset",
"symptom_onset_rel")) %>%
.[, date := dmy(date)] %>%
.[, symptom_onset := dmy(symptom_onset)] %>%
.[voc == "Delta", voc := "delta"] %>%
.[voc == "Omicron", voc := "omicron"] %>%
.[voc == "OMicron", voc := "omicron"] %>%
.[voc == "omicron" | voc == "delta" |
voc == "Positive" | voc == "positive" |
voc == "alpha" | voc == "Positive SARS-CoV-2", result := 1] %>%
.[voc == "negative" | voc == "SARS-CoV-2 Not Detected", result := 0] %>%
.[voc == "negative" | voc == "SARS-CoV-2 Not Detected" |
voc == "SARS-CoV-2 Inconclusive" | voc == "?SGTF" |
voc == "retest/inconsistent" | voc == "Positive" | voc == "positive" |
voc == "Positive SARS-CoV-2", voc := NA] %>%
.[is.na(ct_value), ct_value := NA] %>%
.[result == 0, ct_value := 45] %>%
.[, day_rel := as.numeric(date - min(date), units = "days"),
by = c("id", "infection_id")] %>%
.[, symp_rel := as.numeric(symptom_onset - min(date), units = "days"),
by = c("id", "infection_id")]
# imputing missing onset dates where none are given
dt.ct[is.na(symptom_onset_rel) == TRUE, symp_rel := -7]
# preparing stan data
mn <- dt.ct[, min(ct_value, na.rm = TRUE)]
mx <- dt.ct[, max(ct_value, na.rm = TRUE)]
# scale Ct values
dt.ct[, ct_scaled := (ct_value - mn)/(mx - mn)]
# choosing with voc to fit to
dt.ct.delta <- dt.ct[voc == "delta" | voc == "negative"] %>%
.[, id := .GRP, by = id]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
stan_data_delta
lapply(stan_data_delta, function(x) length(x))
dt.ct.delta
dt.ct.delta %>% View()
stan_data_fun <- function(input_data) {
list(N = input_data[, .N],
P = input_data[, uniqueN(id)],
id = input_data[, id],
day_rel = input_data[, day_rel],
ct_value = ifelse(is.na(input_data$ct_value), -99, input_data$ct_scaled),
pcr_res = input_data[, as.numeric(result)],
symp_rel = input_data[, unique(symp_rel), by = c("id", "infection_id")][, V1],
t_e = 0,
c_0 = (45 - mn)/(mx - mn),
c_lod = (45 - mn)/(mx - mn),
lmean = EpiNow2::incubation_periods[, mean],
lsd = EpiNow2::incubation_periods[, sd])
}
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
stan_data_delta
dt.ct.delta[, symp_rel]
dt.ct.delta[, symp_rel, by = id]
stan_data_fun <- function(input_data) {
list(N = input_data[, .N],
P = input_data[, uniqueN(id)],
id = input_data[, id],
day_rel = input_data[, day_rel],
ct_value = ifelse(is.na(input_data$ct_value), -99, input_data$ct_scaled),
pcr_res = input_data[, as.numeric(result)],
symp_rel = input_data[, symp_rel, by = id],
t_e = 0,
c_0 = (45 - mn)/(mx - mn),
c_lod = (45 - mn)/(mx - mn),
lmean = EpiNow2::incubation_periods[, mean],
lsd = EpiNow2::incubation_periods[, sd])
}
stan_data_fun <- function(input_data) {
stan_data <- list(N = input_data[, .N],
P = input_data[, uniqueN(id)],
id = input_data[, id],
day_rel = input_data[, day_rel],
ct_value = ifelse(is.na(input_data$ct_value), -99, input_data$ct_scaled),
pcr_res = input_data[, as.numeric(result)],
symp_rel = input_data[, symp_rel, by = id],
t_e = 0,
c_0 = (45 - mn)/(mx - mn),
c_lod = (45 - mn)/(mx - mn),
lmean = EpiNow2::incubation_periods[, mean],
lsd = EpiNow2::incubation_periods[, sd])
return(stan_data)
}
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
dt.ct[, symp_rel, by = id]
dt.ct[, (symp_rel), by = id]
dt.ct[, .(symp_rel), by = id]
dt.ct[, .(symp_rel), by = id][, symp_rel]
stan_data_fun <- function(input_data) {
stan_data <- list(N = input_data[, .N],
P = input_data[, uniqueN(id)],
id = input_data[, id],
day_rel = input_data[, day_rel],
ct_value = ifelse(is.na(input_data$ct_value), -99, input_data$ct_scaled),
pcr_res = input_data[, as.numeric(result)],
symp_rel = input_data[, .(symp_rel), by = id][, symp_rel],
t_e = 0,
c_0 = (45 - mn)/(mx - mn),
c_lod = (45 - mn)/(mx - mn),
lmean = EpiNow2::incubation_periods[, mean],
lsd = EpiNow2::incubation_periods[, sd])
return(stan_data)
}
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
dt.ct[, .(symp_rel), by = id][, symp_rel]
dt.ct[, symp_rel, by = id]
dt.ct.delta[, symp_rel, by = id]
dt.ct.delta[, unqiue(symp_rel), by = id]
dt.ct.delta[, unique(symp_rel), by = id]
dt.ct.delta[id == 10]
dt.ct.delta[id == 20]
source("ct_dynamics/R/stan_data.R")
source("ct_dynamics/R/stan_data.R")
dt.ct <- fread("ct_dynamics/data/ct_values_updated.csv") %>%
setnames(., c("Study number", "sample date", "barcode",
"Ct", "swab type", "sample order", "Day post swab 1",
"VOC", "Symptom onset", "Days post symptom onset"),
c("id", "date", "barcode", "ct_value", "swab_type", "sample_id",
"days_since_first_swab", "voc", "symptom_onset",
"symptom_onset_rel")) %>%
.[, date := dmy(date)] %>%
.[, symptom_onset := dmy(symptom_onset)] %>%
.[voc == "Delta", voc := "delta"] %>%
.[voc == "Omicron", voc := "omicron"] %>%
.[voc == "OMicron", voc := "omicron"] %>%
.[voc == "omicron" | voc == "delta" |
voc == "Positive" | voc == "positive" |
voc == "alpha" | voc == "Positive SARS-CoV-2", result := 1] %>%
.[voc == "negative" | voc == "SARS-CoV-2 Not Detected", result := 0] %>%
.[voc == "negative" | voc == "SARS-CoV-2 Not Detected" |
voc == "SARS-CoV-2 Inconclusive" | voc == "?SGTF" |
voc == "retest/inconsistent" | voc == "Positive" | voc == "positive" |
voc == "Positive SARS-CoV-2", voc := NA] %>%
.[is.na(ct_value), ct_value := NA] %>%
.[result == 0, ct_value := 45] %>%
.[, day_rel := as.numeric(date - min(date), units = "days"),
by = c("id", "infection_id")] %>%
.[, symp_rel := as.numeric(symptom_onset - min(date), units = "days"),
by = c("id", "infection_id")]
# imputing missing onset dates where none are given
dt.ct[is.na(symptom_onset_rel) == TRUE, symp_rel := -7]
# preparing stan data
mn <- dt.ct[, min(ct_value, na.rm = TRUE)]
mx <- dt.ct[, max(ct_value, na.rm = TRUE)]
# scale Ct values
dt.ct[, ct_scaled := (ct_value - mn)/(mx - mn)]
# choosing with voc to fit to
dt.ct.delta <- dt.ct[voc == "delta" | voc == "negative"] %>%
.[, id := .GRP, by = id]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
dt.ct.delta[, symp_rel]
dt.ct.delta[, symp_rel, by = id]
dt.ct.delta[, unique(symp_rel), by = id]
dt.ct <- fread("ct_dynamics/data/ct_values_updated.csv") %>%
setnames(., c("Study number", "sample date", "barcode",
"Ct", "swab type", "sample order", "Day post swab 1",
"VOC", "Symptom onset", "Days post symptom onset"),
c("id", "date", "barcode", "ct_value", "swab_type", "sample_id",
"days_since_first_swab", "voc", "symptom_onset",
"symptom_onset_rel")) %>%
.[, date := dmy(date)] %>%
.[, symptom_onset := dmy(symptom_onset)] %>%
.[voc == "Delta", voc := "delta"] %>%
.[voc == "Omicron", voc := "omicron"] %>%
.[voc == "OMicron", voc := "omicron"] %>%
.[voc == "omicron" | voc == "delta" |
voc == "Positive" | voc == "positive" |
voc == "alpha" | voc == "Positive SARS-CoV-2", result := 1] %>%
.[voc == "negative" | voc == "SARS-CoV-2 Not Detected", result := 0] %>%
.[voc == "negative" | voc == "SARS-CoV-2 Not Detected" |
voc == "SARS-CoV-2 Inconclusive" | voc == "?SGTF" |
voc == "retest/inconsistent" | voc == "Positive" | voc == "positive" |
voc == "Positive SARS-CoV-2", voc := NA] %>%
.[is.na(ct_value), ct_value := NA] %>%
.[result == 0, ct_value := 45] %>%
.[, day_rel := as.numeric(date - min(date), units = "days"),
by = c("id", "infection_id")] %>%
.[, symp_rel := as.numeric(symptom_onset - min(date), units = "days"),
by = c("id", "infection_id")]
dt.ct
dt.ct
dt.ct[id == 158]
# imputing missing onset dates where none are given
dt.ct[is.na(symp_rel) == TRUE, symp_rel := -7]
# preparing stan data
mn <- dt.ct[, min(ct_value, na.rm = TRUE)]
mx <- dt.ct[, max(ct_value, na.rm = TRUE)]
# scale Ct values
dt.ct[, ct_scaled := (ct_value - mn)/(mx - mn)]
# choosing with voc to fit to
dt.ct.delta <- dt.ct[voc == "delta" | voc == "negative"] %>%
.[, id := .GRP, by = id]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
# choosing with voc to fit to
dt.ct.delta[, symp_rel, by = id]
# choosing with voc to fit to
dt.ct.delta[, unique(symp_rel), by = id]
# choosing with voc to fit to
dt.ct.delta[, (symp_rel = unique(symp_rel)), by = id]
# choosing with voc to fit to
dt.ct.delta[, .(symp_rel = unique(symp_rel)), by = id]
# choosing with voc to fit to
dt.ct.delta[, .(symp_rel = unique(symp_rel)), by = id][, symp_rel]
stan_data_fun <- function(input_data) {
stan_data <- list(N = input_data[, .N],
P = input_data[, uniqueN(id)],
id = input_data[, id],
day_rel = input_data[, day_rel],
ct_value = ifelse(is.na(input_data$ct_value), -99, input_data$ct_scaled),
pcr_res = input_data[, as.numeric(result)],
symp_rel = input_data[, .(symp_rel = unique(symp_rel)), by = id][, symp_rel],
t_e = 0,
c_0 = (45 - mn)/(mx - mn),
c_lod = (45 - mn)/(mx - mn),
lmean = EpiNow2::incubation_periods[, mean],
lsd = EpiNow2::incubation_periods[, sd])
return(stan_data)
}
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
fit_omicron <- sampling(mod,
data = stan_data_omicron,
iter = 2000)
# rstan_options(auto_write = TRUE)
mod <- rstan::stan_model("ct_dynamics/stan/ct_trajectory_model.stan")
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
dt.ct.delta
dt.ct.delta[, min(date)]
dt.ct.delta[, min(symptom_onset)]
dt.ct.delta[, min(symptom_onset, na.rm = TRUE)]
start_date_delta <- dt.ct.delta[, min(symptom_onset, na.rm = TRUE)]
start_date_omicron <- dt.ct.omicron[, min(symptom_onset, na.rm = TRUE)]
start_date_omicron
start_date_omicron <- dt.ct.omicron[, min(date, na.rm = TRUE)]
start_date_omicron
dt.ct.delta <- dt.ct[voc == "delta" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_delta <- dt.ct.delta[, min(symptom_onset, na.rm = TRUE)]
dt.ct.delta[, day_rel := date - start_date, by = "id"] %>%
.[, symp_rel := symp_rel - start_date, by = "id"]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_omicron <- dt.ct.omicron[, min(date, na.rm = TRUE)]
dt.ct.omicron[, day_rel := date - start_date, by = "id"] %>%
.[, symp_rel := symp_rel - start_date, by = "id"]
# choosing with voc to fit to
dt.ct.delta <- dt.ct[voc == "delta" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_delta <- dt.ct.delta[, min(symptom_onset, na.rm = TRUE)]
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[, symp_rel := symp_rel - start_date_delta, by = "id"]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_omicron <- dt.ct.omicron[, min(date, na.rm = TRUE)]
dt.ct.omicron[, day_rel := date - start_date_omicron, by = "id"] %>%
.[, symp_rel := symp_rel - start_date_omicron, by = "id"]
start_date_delta
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_delta, units = "days"),
by = "id"]
# choosing with voc to fit to
dt.ct.delta <- dt.ct[voc == "delta" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_delta <- dt.ct.delta[, min(symptom_onset, na.rm = TRUE)]
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_delta, units = "days"),
by = "id"]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_omicron <- dt.ct.omicron[, min(date, na.rm = TRUE)]
dt.ct.omicron[, day_rel := date - start_date_omicron, by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_omicron, units = "days"),
by = "id"]
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
dt.ct.delta
# choosing with voc to fit to
dt.ct.delta <- dt.ct[voc == "delta" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_delta <- dt.ct.delta[, min(symptom_onset, na.rm = TRUE)]
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_delta, units = "days"),
by = "id"] %>%
.[is.na(symp_rel), symp_rel = min(date) - 7, by = "id"]
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_delta, units = "days"),
by = "id"] %>%
.[is.na(symp_rel), symp_rel := as.numeric(min(date) - 7, units = "days"),
by = "id"]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_omicron <- dt.ct.omicron[, min(date, na.rm = TRUE)]
dt.ct.omicron[, day_rel := date - start_date_omicron, by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_omicron, units = "days"),
by = "id"] %>%
.[is.na(symp_rel), symp_rel := as.numeric(min(date) - 7, units = "days"),
by = "id"]
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
stan_dens(fit_delta, pars = "c_s")
tmp <- stan_dens(fit_delta, pars = "T_e")
ggsave("T_e_plots.png",
tmp,
width = 10,
height = 10,
bg = "white")
fit_delta %>% colnames()
fit_delta$names
tmp <- stan_dens(fit_delta, pars = "T_e") +
xlim(-3, 3)
ggsave("T_e_plots.png",
tmp,
width = 10,
height = 10,
bg = "white")
fit_delta[id == 29]
dt.ct.delta[id == 29]
dt.ct.delta
dt.ct.delta[id == 1]
dt.ct.delta[id == 2]
dt.ct.delta[id == 2, min(date)]
dt.ct.delta[id == 2, min(date), by = "id"]
dt.ct.delta[id == 1, min(date), by = "id"]
dt.ct.delta[id == 1, min(date) - 7, by = "id"]
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_delta, units = "days"),
by = "id"] %>%
.[is.na(symp_rel), symp_rel := min(date) - 7,
by = "id"]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_omicron <- dt.ct.omicron[, min(date, na.rm = TRUE)]
dt.ct.omicron[, day_rel := date - start_date_omicron, by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_omicron, units = "days"),
by = "id"] %>%
.[is.na(symp_rel), symp_rel := min(date) - 7,
by = "id"]
dt.ct.omicron
dt.ct.omicron[id == 1]
dt.ct.delta$symp_rel
dt.ct.delta[id == 1]
dt.ct.delta[id == 1, min(date) - 7]
dt.ct.delta[id == 1, min(date) - 7, by = id]
dt.ct.delta[, min(date) - 7, by = id]
dt.ct.delta[, as.numeric(min(date) - 7, units = "days"), by = id]
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[is.na(symp_rel), symp_rel := min(date) - 7,
by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_delta, units = "days"),
by = "id"]
dt.ct.delta$symp_rel
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[is.na(symp_rel), symptom_onset := min(date) - 7,
by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_delta, units = "days"),
by = "id"]
dt.ct.delta$symp_rel
# choosing with voc to fit to
dt.ct.delta <- dt.ct[voc == "delta" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_delta <- dt.ct.delta[, min(symptom_onset, na.rm = TRUE)]
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[is.na(symp_rel), symptom_onset := min(date) - 7,
by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_delta, units = "days"),
by = "id"]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_omicron <- dt.ct.omicron[, min(date, na.rm = TRUE)]
dt.ct.omicron[, day_rel := date - start_date_omicron, by = "id"] %>%
.[is.na(symp_rel), symptom_onset := min(date) - 7,
by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_omicron, units = "days"),
by = "id"]
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
dt.ct.delta$symp_rel
# choosing with voc to fit to
dt.ct.delta <- dt.ct[voc == "delta" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_delta <- dt.ct.delta[, min(symptom_onset, na.rm = TRUE)]
dt.ct.delta[, day_rel := date - start_date_delta, by = "id"] %>%
.[is.na(symptom_onset), symptom_onset := min(date) - 7,
by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_delta, units = "days"),
by = "id"]
dt.ct.omicron <- dt.ct[voc == "omicron" | voc == "negative"] %>%
.[, id := .GRP, by = id]
start_date_omicron <- dt.ct.omicron[, min(date, na.rm = TRUE)]
dt.ct.omicron[, day_rel := date - start_date_omicron, by = "id"] %>%
.[is.na(symptom_onset), symptom_onset := min(date) - 7,
by = "id"] %>%
.[, symp_rel := as.numeric(symptom_onset - start_date_omicron, units = "days"),
by = "id"]
# Construct stan data
stan_data_delta <- stan_data_fun(dt.ct.delta)
stan_data_omicron <- stan_data_fun(dt.ct.omicron)
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
tmp <- stan_dens(fit_delta, pars = "T_e")
ggsave("T_e_plots.png",
tmp,
width = 10,
height = 10,
bg = "white")
stan_data_delta
stan_data_delta$symp_rel
# rstan_options(auto_write = TRUE)
mod <- rstan::stan_model("ct_dynamics/stan/ct_trajectory_model.stan")
# rstan_options(auto_write = TRUE)
mod <- rstan::stan_model("ct_dynamics/stan/ct_trajectory_model.stan")
# rstan_options(auto_write = TRUE)
mod <- rstan::stan_model("ct_dynamics/stan/ct_trajectory_model.stan")
fit_delta <- sampling(mod,
data = stan_data_delta,
iter = 2000)
tmp <- stan_dens(fit_delta, pars = "T_e")
ggsave("outputs/T_e_plots.png",
tmp,
width = 10,
height = 10,
bg = "white")
ggsave("ct_dynamics/outputs/all_Te.png",
tmp,
width = 10,
height = 10,
bg = "white")
